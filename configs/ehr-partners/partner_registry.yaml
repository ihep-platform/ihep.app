# =============================================================================
# IHEP EHR Partner Registry
# =============================================================================
# Master configuration for all connected EHR partner systems.
# Each partner entry defines connection details, data scope, and sync settings.
#
# Author: Jason M Jarmacz | Co-Author: Claude by Anthropic
# =============================================================================

version: "1.0"
last_updated: "2026-02-22T00:00:00Z"

# Default settings applied to all partners unless overridden
defaults:
  sync:
    mode: bidirectional
    frequency_minutes: 15
    webhook_enabled: true
    batch_size: 100
    retry_attempts: 3
  data_scope:
    patients: true
    observations: true
    appointments: true
    care_plans: true
    medications: false
    encounters: true
  rate_limits:
    requests_per_minute: 60
    requests_per_hour: 1000

# Connected EHR partners
partners:
  - id: "epic-sandbox-001"
    name: "Epic Sandbox (App Orchard)"
    ehr_vendor: epic
    status: sandbox
    enabled: true
    connection:
      type: smart_on_fhir
      base_url: "https://fhir.epic.com/interconnect-fhir-oauth/api/FHIR/R4"
      auth_url: "https://fhir.epic.com/interconnect-fhir-oauth/oauth2/authorize"
      token_url: "https://fhir.epic.com/interconnect-fhir-oauth/oauth2/token"
      client_id: "${SECRET_EPIC_CLIENT_ID}"
      client_secret: "${SECRET_EPIC_CLIENT_SECRET}"
      scopes:
        - "patient/Patient.read"
        - "patient/Observation.read"
        - "patient/Appointment.read"
        - "patient/CarePlan.read"
        - "launch/patient"
    data_scope:
      patients: true
      observations: true
      appointments: true
      care_plans: true
      medications: false
    sync:
      mode: bidirectional
      frequency_minutes: 15
      webhook_enabled: true
    field_mappings:
      patient:
        mrn_system: "urn:oid:1.2.840.114350.1.13.0.1.7.5.737384.14"
        custom_extensions:
          - "http://open.epic.com/FHIR/StructureDefinition/extension/mychart-status"
    mirth_channel: epic_inbound
    notes: "Epic App Orchard sandbox for development and testing"

  - id: "cerner-sandbox-001"
    name: "Cerner Code Sandbox"
    ehr_vendor: cerner
    status: sandbox
    enabled: true
    connection:
      type: oauth2
      base_url: "https://fhir-open.cerner.com/r4/ec2458f2-1e24-41c8-b71b-0e701af7583d"
      auth_url: "https://authorization.cerner.com/tenants/ec2458f2-1e24-41c8-b71b-0e701af7583d/protocols/oauth2/profiles/smart-v1/personas/provider/authorize"
      token_url: "https://authorization.cerner.com/tenants/ec2458f2-1e24-41c8-b71b-0e701af7583d/protocols/oauth2/profiles/smart-v1/token"
      client_id: "${SECRET_CERNER_CLIENT_ID}"
      client_secret: "${SECRET_CERNER_CLIENT_SECRET}"
      scopes:
        - "patient/Patient.read"
        - "patient/Observation.read"
        - "patient/Appointment.read"
    data_scope:
      patients: true
      observations: true
      appointments: true
      care_plans: true
    sync:
      mode: bidirectional
      frequency_minutes: 15
      webhook_enabled: true
    field_mappings:
      patient:
        mrn_system: "urn:oid:2.16.840.1.113883.6.1000"
        custom_extensions: []
    mirth_channel: cerner_inbound
    notes: "Cerner Code program sandbox instance"

  - id: "allscripts-sandbox-001"
    name: "Allscripts Unity Sandbox"
    ehr_vendor: allscripts
    status: sandbox
    enabled: true
    connection:
      type: api_key
      base_url: "https://cloud.allscriptsunity.com/FHIR/R4"
      api_key: "${SECRET_ALLSCRIPTS_API_KEY}"
      app_name: "${SECRET_ALLSCRIPTS_APP_NAME}"
    data_scope:
      patients: true
      observations: true
      appointments: true
      care_plans: false
    sync:
      mode: inbound_only
      frequency_minutes: 30
      webhook_enabled: false
    field_mappings:
      patient:
        mrn_system: "urn:oid:2.16.840.1.113883.3.29"
    mirth_channel: allscripts_inbound
    notes: "Allscripts Unity API sandbox"

  - id: "athena-sandbox-001"
    name: "athenahealth API Sandbox"
    ehr_vendor: athenahealth
    status: sandbox
    enabled: true
    connection:
      type: oauth2
      base_url: "https://api.preview.platform.athenahealth.com/fhir/r4"
      auth_url: "https://api.preview.platform.athenahealth.com/oauth2/v1/authorize"
      token_url: "https://api.preview.platform.athenahealth.com/oauth2/v1/token"
      client_id: "${SECRET_ATHENA_CLIENT_ID}"
      client_secret: "${SECRET_ATHENA_CLIENT_SECRET}"
      practice_id: "${SECRET_ATHENA_PRACTICE_ID}"
    data_scope:
      patients: true
      observations: true
      appointments: true
      care_plans: false
    sync:
      mode: bidirectional
      frequency_minutes: 15
      webhook_enabled: true
    field_mappings:
      patient:
        mrn_system: "urn:oid:2.16.840.1.113883.3.564"
    mirth_channel: athena_inbound
    notes: "athenahealth preview API sandbox"
